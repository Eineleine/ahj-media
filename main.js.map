{"version":3,"file":"main.js","mappings":"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","sources":["webpack://ahj-media/./src/js/DOM.js","webpack://ahj-media/./src/js/app.js","webpack://ahj-media/./src/js/local_storage.js"],"sourcesContent":["import {\n  btnHandle,\n  closeNotification,\n  getGeolocation,\n  addCoordsHandler,\n} from \"./app.js\";\n\nimport { saveMessage } from \"./local_storage.js\";\n\nexport function addBtnHendler() {\n  const addBtn = document.querySelector(\".btn\");\n\n  addBtn.addEventListener(\"click\", (e) => {\n    e.preventDefault();\n    const field = document.querySelector(\".text\");\n    const value = field.value;\n    if (value.trim() === \"\") {\n      return;\n    }\n\n    createMessage(value);\n    field.value = \"\";\n  });\n}\n\nexport function patternMessage(text) {\n  const container = document.querySelector(\".messages\");\n\n  const message = document.createElement(\"div\");\n  message.classList.add(\"message\");\n\n  const textMesage = document.createElement(\"span\");\n  textMesage.classList.add(\"textMesage\");\n  textMesage.textContent = text;\n\n  const removeBtn = document.createElement(\"button\");\n  removeBtn.classList.add(\"remove\");\n  removeBtn.textContent = \"\\u2715\";\n  removeBtn.addEventListener(\"click\", btnHandle);\n\n  message.appendChild(textMesage);\n  message.appendChild(removeBtn);\n  container.appendChild(message);\n\n  return message;\n}\n\nexport async function createMessage(text) {\n  const geolocation = document.createElement(\"span\");\n  geolocation.classList.add(\"geo\");\n  try {\n    const location = await getGeolocation();\n    geolocation.textContent = location;\n  } catch (err) {\n    geolocation.textContent = \"\";\n  }\n\n  const message = patternMessage(text);\n  message.appendChild(geolocation);\n  saveMessage(text, geolocation.textContent);\n}\n\nexport function createNotification() {\n  const body = document.getElementsByTagName(\"body\")[0];\n  const container = document.createElement(\"div\");\n  container.classList.add(\"notification\");\n  container.style.display = \"flex\";\n\n  const textInformation = document.createElement(\"span\");\n  textInformation.classList.add(\"textMesage\");\n  textInformation.innerHTML =\n    \"Что-то пошло не так.<br>К сожалению, нам не удалось определить ваше местоположение. Дайте разрешение на использование геолокации, либо введите координаты вручную.<br> Широта и долгота через запятую.\";\n\n  const closeBtn = document.createElement(\"button\");\n  closeBtn.classList.add(\"removeBtn\");\n  closeBtn.textContent = \"\\u2715\";\n  closeBtn.addEventListener(\"click\", closeNotification);\n\n  const form = document.createElement(\"form\");\n  form.classList.add(\"form\");\n\n  const field = document.createElement(\"textarea\");\n  field.classList.add(\"textCoord\");\n  field.placeholder = \"51.50851, -0.12572\";\n\n  const buttonOk = document.createElement(\"button\");\n  buttonOk.classList.add(\"btnOk\");\n  buttonOk.textContent = \"OK\";\n  buttonOk.addEventListener(\"click\", addCoordsHandler);\n\n  form.appendChild(field);\n  form.appendChild(buttonOk);\n\n  container.appendChild(textInformation);\n  container.appendChild(closeBtn);\n  container.appendChild(form);\n\n  body.appendChild(container);\n}\n\nexport function addCoords(value) {\n  const message = document.querySelector(\".messages\");\n  const currentMessage = message.lastChild;\n  const coords = document.createElement(\"span\");\n  coords.textContent = value;\n  coords.classList.add(\"geo\");\n  currentMessage.appendChild(coords);\n}\n","import { createNotification, addCoords, addBtnHendler } from \"./DOM.js\";\n\nimport { removeMessage, loadMessages } from \"./local_storage.js\";\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  loadMessages();\n  addBtnHendler();\n});\n\nexport function btnHandle(e) {\n  e.preventDefault();\n  const removeBtn = e.target;\n  const parent = removeBtn.closest(\".message\");\n  const textMessage = parent.querySelector(\".textMesage\");\n  console.log(textMessage);\n  if (textMessage) {\n    removeMessage(textMessage.textContent);\n  }\n  if (parent) {\n    parent.remove();\n  }\n}\n\nexport function closeNotification() {\n  const notification = document.querySelector(\".notification\");\n  notification.remove();\n}\n\nexport function getGeolocation() {\n  return new Promise((resolve, reject) => {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(\n        function (data) {\n          const { latitude, longitude } = data.coords;\n          resolve(`${latitude}, ${longitude}`);\n        },\n        function (err) {\n          console.log(err);\n          createNotification();\n          reject(err);\n        },\n      );\n    } else {\n      reject(new Error(\"Геолокация не поддерживается браузером\"));\n    }\n  });\n}\n\nexport function parseCoordinates(input) {\n  input = input.replace(/[[]/g, \"\").trim();\n\n  const [latStr, lonStr] = input.split(\",\").map((str) => str.trim());\n\n  const latitude = parseFloat(latStr);\n  const longitude = parseFloat(lonStr);\n\n  if (\n    isNaN(latitude) ||\n    isNaN(longitude) ||\n    latitude < -90 ||\n    latitude > 90 ||\n    longitude < -180 ||\n    longitude > 180\n  ) {\n    alert(\"Невалидный формат\");\n    return;\n  }\n\n  return `${latitude}, ${longitude}`;\n}\n\nexport function addCoordsHandler(e) {\n  e.preventDefault();\n\n  const field = document.querySelector(\".textCoord\");\n  const value = field.value;\n  if (value.trim() === \"\") {\n    return;\n  }\n  const coords = parseCoordinates(value);\n  addCoords(coords);\n  field.value = \"\";\n  closeNotification();\n}\n","import { patternMessage } from \"./DOM.js\";\n\nexport function saveMessage(text, location) {\n  //console.log(location);\n  const messages = JSON.parse(localStorage.getItem(\"messages\")) || [];\n  messages.push({ text, location });\n  localStorage.setItem(\"messages\", JSON.stringify(messages));\n}\n\nexport function removeMessage(text) {\n  let messages = JSON.parse(localStorage.getItem(\"messages\")) || [];\n  messages = messages.filter((message) => message.text !== text);\n  localStorage.setItem(\"messages\", JSON.stringify(messages));\n}\n\nexport function loadMessages() {\n  const messages = JSON.parse(localStorage.getItem(\"messages\")) || [];\n  messages.forEach(({ text, location }) => {\n    const message = patternMessage(text);\n\n    const geolocation = document.createElement(\"span\");\n    geolocation.classList.add(\"geo\");\n    geolocation.textContent = location;\n\n    message.appendChild(geolocation);\n  });\n}\n"],"names":["patternMessage","text","container","document","querySelector","message","createElement","classList","add","textMesage","textContent","removeBtn","addEventListener","btnHandle","appendChild","e","preventDefault","parent","target","closest","textMessage","console","log","messages","JSON","parse","localStorage","getItem","filter","setItem","stringify","removeMessage","remove","closeNotification","addCoordsHandler","field","value","trim","currentMessage","lastChild","coords","addCoords","input","replace","latStr","lonStr","split","map","str","latitude","parseFloat","longitude","isNaN","alert","parseCoordinates","forEach","location","geolocation","async","Promise","resolve","reject","navigator","getCurrentPosition","data","err","body","getElementsByTagName","style","display","textInformation","innerHTML","closeBtn","form","placeholder","buttonOk","createNotification","Error","push","saveMessage","createMessage"],"sourceRoot":""}